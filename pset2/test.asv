

betas_rho= fminunc(@(params)gmm_crit(params(1:4), data2), [0.3; 0.3; 0.4; 0.88]);

par = [0.3; 0.3; 0.4; 0.88];


function objective = gmm_crit(par, logR, logK, logL, logLagK, logLagL, lagPhi)

rhs = [ones(9000, 1) , log(data2(:, [1 2 5 6])) ,data2(:, [9 10])]';




beta0 = par(1);
betak = par(2);
betal = par(3);
rho = par(4);

xi = (logR - beta0 - betak*logK - betal*logL- rho.*(lagPhi - beta0 - betak rhs([1 4:5], :)'*beta))';


objective = sum(xi)^2;

end